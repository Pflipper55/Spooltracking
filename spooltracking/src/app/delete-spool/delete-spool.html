<p-dialog
  [(visible)]="visible"
  [header]="'Remove Spool'"
  [modal]="true"
  [style]="{ width: '40vw' }"
  [breakpoints]="{ '960px': '75vw', '640px': '90vw' }"
>
  <div class="dialog-content">
    <!-- Step 1: Spool Selection -->
    @if (spoolSelectionStep) {
      <div>
        <h3>Select Spool to remove</h3>
        
        <!-- Error Message -->
        @if (error) {
          <div class="error-message">
            <p>{{ error }}</p>
          </div>
        }

        <!-- Spool Dropdown -->
        <div class="form-group">
          <label for="spools">Spool *</label>
          <p-list-box
            id="spools"
            [(ngModel)]="selectedSpoolId"
            [options]="allSpools()"
            optionLabel="material"
            optionValue="id"
            placeholder="Select a spool to delete"
          >
            <ng-template let-spool pTemplate="item">
              <span>{{ spool.brand?.name }} - {{ spool.color }} ({{ spool.material }}, {{ spool.weight }}g)</span>
            </ng-template>
          </p-list-box>
        </div>
      </div>
    }

    <!-- Step 2: Edit Form -->
    @if (!spoolSelectionStep && selectedSpool) {
      <div>
        <h3>Delete: {{ selectedSpool.brand?.name }} - {{ selectedSpool.color }} Id: {{selectedSpoolId}}?</h3>
        
        <!-- Error Message -->
        @if (error) {
          <div class="error-message">
            <p>{{ error }}</p>
          </div>
        }

        <p>Are you sure you want to remove the spool: {{ selectedSpool.brand?.name }} - {{ selectedSpool.color }}</p>
      </div>
    }
  </div>

  <ng-template pTemplate="footer" class="flex gap-1">
    @if (spoolSelectionStep) {
      <button
        pButton
        pRipple
        type="button"
        label="Select"
        icon="pi pi-check"
        (click)="onSelectButtonClick()"
        class="p-button-text"
        severity="contrast"
        [raised]="true"
        [disabled]="!selectedSpoolId"
      ></button>
      <button
        pButton
        pRipple
        type="button"
        label="Cancel"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideDialog()"
        [disabled]="loading"
      ></button>
    } @else {
      <button
        pButton
        pRipple
        type="button"
        label="Select other Spool"
        icon="pi pi-arrow-left"
        class="p-button-text"
        (click)="goBackToSelection()"
        [disabled]="loading"
      ></button>
      <button
        pButton
        pRipple
        type="button"
        label="Cancel"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideDialog()"
        [disabled]="loading"
      ></button>
      <button
        pButton
        pRipple
        type="button"
        label="Delete"
        icon="pi pi-trash"
        severity="danger"
        (click)="onSubmit()"
        [disabled]="loading"
      ></button>
    }
  </ng-template>
</p-dialog>
